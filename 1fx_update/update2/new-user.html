<!DOCTYPE html>
<html>
<head>
	<title>Detail Admin - New User Form</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
    <!-- bootstrap -->
    <link href="css/bootstrap/bootstrap.css" rel="stylesheet" />
    <link href="css/bootstrap/bootstrap-overrides.css" type="text/css" rel="stylesheet" />

    <!-- global styles -->
    <link rel="stylesheet" type="text/css" href="css/compiled/layout.css" />
    <link rel="stylesheet" type="text/css" href="css/compiled/elements.css" />
    <link rel="stylesheet" type="text/css" href="css/compiled/icons.css" />

    <!-- libraries -->
    <link rel="stylesheet" type="text/css" href="css/lib/font-awesome.css" />
    
    <!-- this page specific styles -->
    <link rel="stylesheet" href="css/compiled/new-user.css" type="text/css" media="screen" />

    <!-- open sans font -->
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css' />
     <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body>

    <!-- navbar -->
    <header class="navbar navbar-inverse" role="banner">
        <div class="navbar-header">
            <button class="navbar-toggle" type="button" data-toggle="collapse" id="menu-toggler">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
           <a class="navbar-brand"><img class="logo" src="images/logo_dashboard.svg" alt="logo" /></a>
        </div>
        <ul class="nav navbar-nav pull-right hidden-xs">
            <li class="hidden-xs hidden-sm">
                <input type="hidden" class="token" id="token"/>
                <input type="hidden" class="email" id="email"/>
                <input class="search" type="text" />
            </li>
            <li class="notification-dropdown hidden-xs hidden-sm">
                <a href="#" class="trigger">
                    <i class="icon-warning-sign"></i>
                    <span class="count">8</span>
                </a>
                <div class="pop-dialog">
                    <div class="pointer right">
                        <div class="arrow"></div>
                        <div class="arrow_border"></div>
                    </div>
                    <div class="body">
                        <a href="#" class="close-icon"><i class="icon-remove-sign"></i></a>
                        <div class="notifications">
                            <h3>You have 6 new notifications</h3>
                            <a href="#" class="item">
                                <i class="icon-signin"></i> New user registration
                                <span class="time"><i class="icon-time"></i> 13 min.</span>
                            </a>
                            <a href="#" class="item">
                                <i class="icon-signin"></i> New user registration
                                <span class="time"><i class="icon-time"></i> 18 min.</span>
                            </a>
                            <a href="#" class="item">
                                <i class="icon-envelope-alt"></i> New message from Alejandra
                                <span class="time"><i class="icon-time"></i> 28 min.</span>
                            </a>
                            <a href="#" class="item">
                                <i class="icon-signin"></i> New user registration
                                <span class="time"><i class="icon-time"></i> 49 min.</span>
                            </a>
                            <a href="#" class="item">
                                <i class="icon-download-alt"></i> New order placed
                                <span class="time"><i class="icon-time"></i> 1 day.</span>
                            </a>
                            <div class="footer">
                                <a href="#" class="logout">View all notifications</a>
                            </div>
                        </div>
                    </div>
                </div>
            </li>
            <li class="notification-dropdown hidden-xs hidden-sm">
                <a href="#" class="trigger">
                    <i class="icon-envelope"></i>
                </a>
                <div class="pop-dialog">
                    <div class="pointer right">
                        <div class="arrow"></div>
                        <div class="arrow_border"></div>
                    </div>
                    <div class="body">
                        <a href="#" class="close-icon"><i class="icon-remove-sign"></i></a>
                        <div class="messages">
                            <a href="#" class="item">
                                <img src="img/contact-img.png" class="display" alt="user" />
                                <div class="name">Alejandra Galván</div>
                                <div class="msg">
                                    There are many variations of available, but the majority have suffered alterations.
                                </div>
                                <span class="time"><i class="icon-time"></i> 13 min.</span>
                            </a>
                            <a href="#" class="item">
                                <img src="img/contact-img2.png" class="display" alt="user" />
                                <div class="name">Alejandra Galván</div>
                                <div class="msg">
                                    There are many variations of available, have suffered alterations.
                                </div>
                                <span class="time"><i class="icon-time"></i> 26 min.</span>
                            </a>
                            <a href="#" class="item last">
                                <img src="img/contact-img.png" class="display" alt="user" />
                                <div class="name">Alejandra Galván</div>
                                <div class="msg">
                                    There are many variations of available, but the majority have suffered alterations.
                                </div>
                                <span class="time"><i class="icon-time"></i> 48 min.</span>
                            </a>
                            <div class="footer">
                                <a href="#" class="logout">View all messages</a>
                            </div>
                        </div>
                    </div>
                </div>
            </li>
            <li class="dropdown">
                <a href="#" class="dropdown-toggle hidden-xs hidden-sm" data-toggle="dropdown">
                    Your account
                    <b class="caret"></b>
                </a>
                <ul class="dropdown-menu">
                    <li><a href="personal-info.html">Personal info</a></li>
                    <li><a href="#">Account settings</a></li>
                    <li><a href="#">Billing</a></li>
                    <li><a href="#">Export your data</a></li>
                    <li><a href="#">Send feedback</a></li>
                </ul>
            </li>
            <li class="settings hidden-xs hidden-sm">
                <a href="user-list.html" role="button">
                    <i class="icon-share-alt"></i>
                </a>
            </li>
              <li class="settings hidden-xs hidden-sm">
                <a href="#" id="logout" class="trigger">
                    <i class="fa fa-power-off fa-lg"></i>
                </a>
                 <div class="pop-dialog">
                 dfdf
                 </div>
            </li>
        </ul>
    </header>
    <!-- end navbar -->

     <!-- sidebar -->
    <div id="sidebar-nav">
        <ul id="dashboard-menu">
            <li>
                <a href="dashboard.html">
                    <i class="fa fa-home fa-lg"></i>
                    <span>Dashboard</span>
                </a>
            </li>  
            <li>
                <a  href="credits.html">
                    <i class="fa fa-credit-card fa-lg"></i>
                    <span>Credits</span>
                   
                </a>
                
            </li>
            <li>
                <a href="transaction.html">
                   <i class="fa fa fa-file-text fa-lg"></i>
                  <span>Transaction</span>
                    
                </a>
                
            </li>
            <li class="active">
                 <div class="pointer">
                    <div class="arrow"></div>
                    <div class="arrow_border"></div>
                </div>
                <a href="user-list.html">
                     <i class="fa fa-users fa-lg"></i>
                    <span>Contacts</span>
                   
                </a>
            </li>
            <li>
                <a href="personal-info.html">
                    <i class="fa fa-user fa-lg"></i>
                    <span>Profile</span>
                </a>
            </li>

        </ul>
    </div>
    <!-- end sidebar -->


	<!-- main container -->
    <div class="content">
        
        <!-- settings changer -->
        <div class="skins-nav">
            <a href="#" class="skin first_nav selected">
                <span class="icon"></span><span class="text">Default</span>
            </a>
            <a href="#" class="skin second_nav" data-file="css/compiled/skins/dark.css">
                <span class="icon"></span><span class="text">Dark skin</span>
            </a>
        </div>
        
        <div id="pad-wrapper" class="new-user">
            <div class="row header">
                <div class="col-md-12">
                    <h3>Create a New Contact</h3>
                </div>                
            </div>

            <div class="row form-wrapper">
                <!-- left column -->
                <div class="col-md-9 with-sidebar">
                    <form class="form-horizontal" name="addEmail" id="addEmail" role="form">
                        <div class="form-group">
                            <label for="inputName1" class="col-md-2 control-label">Find via email address:</label>
                            <div class="col-md-8">
                                <input type="text" class="form-control add_email" id="add_email" name="add_email" placeholder="Email">
                                <input type="hidden" class="form-control current_email" id="current_email" name="current_email" placeholder="Email">
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-md-offset-2 col-md-8">
                              <button type="submit" class="btn btn-default" id="add_friend">Add as friend</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
     <div class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-sm">
        <div class="modal-content" id="already_friend" style="padding: 1em;">

        </div>
      </div>
    </div>
    <!-- end main container -->

    <script src="js/1.9.1_jquery.min.js"></script>
    <script src="js/jquery.js"></script>    
    <script src="js/bootstrap.min.js"></script>
    <!-- knob -->
    <script src="js/jquery.knob.js"></script>
    <!-- flot charts -->
    <script src="js/jquery.flot.js"></script>
    <script src="js/jquery.flot.stack.js"></script>
    <script src="js/jquery.flot.resize.js"></script>

    <script type="text/javascript" src="js/ext/jquery.easing.min.js"></script>  
    <script type="text/javascript" src="js/ext/jquery.validate.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function(){

            $.ajax({
              type: "POST",
              // url: "http://1fx.philwebservicesdev.com/TCC/auth.php",
              url: "http://192.168.1.70/TCC/auth.php",
              dataType: "json",
              success: function(result) {
                console.log(result);
                console.log('status = '+result.status);
                

                if (result.status == "success") {
                    var tokenKey = result.token_id;
                    var email = result.email;
                    
                    document.getElementById('token').value = tokenKey;
                    document.getElementById('email').value = email;
                    document.getElementById('current_email').value = email;
                  
                } else {
                    var red = result.redirect;
                    
                    window.location = red;
                }
              }
            });

            $(document).on('click','#add_friend',function(e){
              e.preventDefault();

              var $form = $('form[name="addEmail"]'),
                  data;
              if($form.valid()){
                data = $form.serialize();

                // alert(data); //
                ajax_addEmail(data);
              }
            });

            $('form[name="addEmail"]').validate({
              debug: true,
              rules : {
                add_email : {
                  required: true,
                  email :true,
                  remote : {
                    url: "http://192.168.1.70/controller/validate_notexist.php",
                      type: "post",
                      data: {
                        email: function() {
                        return $( "#add_email" ).val();
                      }
                    }
                  }
                }
              },
              messages : {
                add_email : {
                  required : "Dont Leave blank",
                  email : "Please check inputted email!",
                  remote : "Cannot add if email is not exist!."
                }
              }
            });

            var ajax_addEmail = function(data){
              $.ajax({
                url : "http://192.168.1.70/controller/contact/add_friend_contact.php",
                type: "post",
                dataType : "json",
                data : data,
                success: function(result){
                  if(result.status == 'success'){
                    // console.log(result);
                    window.location = result.redirect;
                  }
                  else{
                    // alert(result.message);
                    $('.bs-example-modal-sm').modal('show');
                    document.getElementById('already_friend').innerHTML = "<div style='text-align:center;'>"+result.message+"</div>";
                  }
                },
                error: function(xhr,status){
                  alert(xhr.responseText);
                }
              });
            }

           $("#logout").click(function (e) {
                e.preventDefault();
                $.ajax({
                  type: "POST",
                  url: "http://192.168.1.70/controller/logout.php",
                  dataType: "json",
                  data:{
                    'logging_out': 'logout',
                    '_token': "",
                    'action': 'logout_app'
                  },
                  success: function(result) {

                    if(result.status === 'logout'){

                        // $('.bs-example-modal-sm').modal('show');
                        // document.getElementById('already_friend').innerHTML = "<div style='text-align:center;'>Thanks for using 1FX Mobile Wallet.</div>";
                        
                        alert("Thanks for using 1FX Mobile Wallet.");
                        window.location = result.redirect;
                    }
                    else{
                        // window.redirect = result.redirect;
                    }
                  }
                });
                // logout();
            });// logout ajax 

        });// end document type
    </script>
</body>
</html>