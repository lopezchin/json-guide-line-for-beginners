(function(e){METRO_DIALOG==undefined;e.Dialog=function(t){if(!e.Dialog.opened){e.Dialog.opened=!0;e.Dialog.settings=t;t=e.extend({icon:!1,title:"",content:"",flat:!1,shadow:!1,overlay:!1,width:"auto",height:"auto",position:"default",padding:!1,overlayClickClose:!0,sysButtons:{btnClose:!0},onShow:function(e){},sysBtnCloseClick:function(e){},sysBtnMinClick:function(e){},sysBtnMaxClick:function(e){}},t);var n,r,i,s;n=e("<div/>").addClass("metro window-overlay");t.overlay&&n.css({backgroundColor:"rgba(0,0,0,.7)"});r=e("<div/>").addClass("window");t.flat&&r.addClass("flat");t.shadow&&r.addClass("shadow").css("overflow","hidden");i=e("<div/>").addClass("caption");s=e("<div/>").addClass("content");s.css({paddingTop:32+t.padding,paddingLeft:t.padding,paddingRight:t.padding,paddingBottom:t.padding});if(t.sysButtons){t.sysButtons.btnClose&&e("<button/>").addClass("btn-close").on("click",function(n){n.preventDefault();n.stopPropagation();e.Dialog.close();t.sysBtnCloseClick(n)}).appendTo(i);t.sysButtons.btnMax&&e("<button/>").addClass("btn-max").on("click",function(e){e.preventDefault();e.stopPropagation();t.sysBtnMaxClick(e)}).appendTo(i);t.sysButtons.btnMin&&e("<button/>").addClass("btn-min").on("click",function(e){e.preventDefault();e.stopPropagation();t.sysBtnMinClick(e)}).appendTo(i)}t.icon&&e(t.icon).addClass("icon").appendTo(i);e("<div/>").addClass("title").html(t.title).appendTo(i);s.html(t.content);i.appendTo(r);s.appendTo(r);r.appendTo(n);t.width!="auto"&&r.css("min-width",t.width);t.height!="auto"&&r.css("min-height",t.height);n.hide().appendTo("body").fadeIn("fast");METRO_DIALOG=r;r.css("position","fixed").css("z-index",parseInt(n.css("z-index"))+1).css("top",(e(window).height()-METRO_DIALOG.outerHeight())/2).css("left",(e(window).width()-r.outerWidth())/2);addTouchEvents(r[0]);t.draggable&&i.on("mousedown",function(t){e.Dialog.drag=!0;i.css("cursor","move");var n=r.css("z-index"),s=r.outerHeight(),o=r.outerWidth(),u=r.offset().top+s-t.pageY,a=r.offset().left+o-t.pageX;r.css("z-index",99999).parents().on("mousemove",function(t){var n=t.pageY>0?t.pageY+u-s:0,i=t.pageX>0?t.pageX+a-o:0;if(e.Dialog.drag){n>=0&&n<=window.innerHeight-r.outerHeight()&&r.offset({top:n});i>=0&&i<=window.innerWidth-r.outerWidth()&&r.offset({left:i})}});t.preventDefault()}).on("mouseup",function(){r.removeClass("draggable");e.Dialog.drag=!1;i.css("cursor","default")});r.on("click",function(e){e.stopPropagation()});t.overlayClickClose&&n.on("click",function(t){t.preventDefault();e.Dialog.close()});t.onShow(METRO_DIALOG);e.Dialog.autoResize();return METRO_DIALOG}return METRO_DIALOG};e.Dialog.content=function(t){if(!e.Dialog.opened||METRO_DIALOG==undefined)return!1;if(t){METRO_DIALOG.children(".content").html(t);e.Dialog.autoResize();return!0}return METRO_DIALOG.children(".content").html()};e.Dialog.title=function(t){if(!e.Dialog.opened||METRO_DIALOG==undefined)return!1;var n=METRO_DIALOG.children(".caption").children(".title");t?n.html(t):n.html();return!0};e.Dialog.autoResize=function(){if(!e.Dialog.opened||METRO_DIALOG==undefined)return!1;var t=METRO_DIALOG.children(".content"),n=(e(window).height()-METRO_DIALOG.outerHeight())/2,r=(e(window).width()-METRO_DIALOG.outerWidth())/2;METRO_DIALOG.css({width:t.outerWidth(),height:t.outerHeight(),top:n,left:r});return!0};e.Dialog.close=function(){if(!e.Dialog.opened||METRO_DIALOG==undefined)return!1;e.Dialog.opened=!1;var t=METRO_DIALOG.parent(".window-overlay");t.fadeOut(function(){e(this).remove()});return!1}})(jQuery);