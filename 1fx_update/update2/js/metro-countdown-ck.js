(function(e){e.widget("metro.countdown",{version:"1.0.0",options:{style:{background:"bg-dark",foreground:"fg-white",divider:"fg-dark"},blink:!0,days:1,stoptimer:0,ontick:function(e,t,n,r){},onstop:function(){}},wrappers:{},_interval:0,_create:function(){var t=this,n=this.element;e.each(["Days","Hours","Minutes","Seconds"],function(){e('<span class="count'+this+'">').html('<span class="digit-wrapper">                        <span class="digit">0</span>                    </span>                    <span class="digit-wrapper">                        <span class="digit">0</span>                    </span>').appendTo(n);this!="Seconds"&&n.append('<span class="divider"></span>')});this.wrappers=this.element.find(".digit-wrapper");n.data("blink")!=undefined&&(this.options.blink=n.data("blick"));n.data("styleBackground")!=undefined&&(this.options.style.background=n.data("styleBackground"));n.data("styleForeground")!=undefined&&(this.options.style.foreground=n.data("styleForeground"));n.data("styleDivider")!=undefined&&(this.options.style.divider=n.data("styleDivider"));this.options.style.background!="default"&&this.element.find(".digit").addClass(this.options.style.background);this.options.style.foreground!="default"&&this.element.find(".digit").addClass(this.options.style.foreground);this.options.style.divider!="default"&&this.element.find(".divider").addClass(this.options.style.divider);n.data("stoptimer")!=undefined&&(this.options.stoptimer=new Date(n.data("stoptimer")));this.options.stoptimer==0&&(this.options.stoptimer=(new Date).getTime()+this.options.days*24*60*60*1e3);setTimeout(function(){t.tick()},1e3)},_destroy:function(){},_setOption:function(e,t){this._super("_setOption",e,t)},tick:function(){var e=this;this._interval=setInterval(function(){var t=86400,n=3600,r=60,i,s,o,u,a;i=Math.floor((e.options.stoptimer-new Date)/1e3);i<0&&(i=0);s=Math.floor(i/t);e.updateDuo(0,1,s);i-=s*t;o=Math.floor(i/n);e.updateDuo(2,3,o);i-=o*n;u=Math.floor(i/r);e.updateDuo(4,5,u);i-=u*r;a=i;e.updateDuo(6,7,a);e.options.ontick(s,o,u,a);e.blinkDivider();if(s===0&&o===0&&u===0&&a===0){e.options.onstop();e.stopDigit();e._trigger("alarm");clearInterval(e._interval)}},1e3)},blinkDivider:function(){this.options.blink&&this.element.find(".divider").toggleClass("no-visible")},stopDigit:function(){this.wrappers.each(function(){e(this).children(".digit").addClass("stop")})},updateDuo:function(e,t,n){this.switchDigit(this.wrappers.eq(e),Math.floor(n/10)%10);this.switchDigit(this.wrappers.eq(t),n%10)},switchDigit:function(t,n){var r=t.find(".digit");if(r.is(":animated"))return!1;if(t.data("digit")==n)return!1;t.data("digit",n);var i=e("<span>",{"class":"digit",css:{top:"-2.1em",opacity:0},html:n});i.addClass(this.options.style.background);i.addClass(this.options.style.foreground);r.before(i).removeClass("static").animate({top:"2.5em"},"fast",function(){r.remove()});i.delay(100).animate({top:0,opacity:1},"fast");return!0}})})(jQuery);